service:
  name: auth-service
  version: 1.0.0
  environment: ${ENV:development}

server:
  port: ${SERVER_PORT:8081}
  host: ${SERVER_HOST:0.0.0.0}
  read_timeout: ${SERVER_READ_TIMEOUT:15s}
  write_timeout: ${SERVER_WRITE_TIMEOUT:15s}
  idle_timeout: ${SERVER_IDLE_TIMEOUT:60s}
  shutdown_timeout: ${SERVER_SHUTDOWN_TIMEOUT:30s}
  max_header_bytes: ${SERVER_MAX_HEADER_BYTES:1048576}
  enable_compression: ${SERVER_ENABLE_COMPRESSION:true}
  tls_enabled: ${TLS_ENABLED:false}
  tls_cert_file: ${TLS_CERT_FILE:}
  tls_key_file: ${TLS_KEY_FILE:}

database:
  postgres:
    host: ${DB_HOST:localhost}
    port: ${DB_PORT:5432}
    user: ${DB_USER:postgres}
    password: ${DB_PASSWORD}
    db_name: ${DB_NAME:auth_db}
    ssl_mode: ${DB_SSL_MODE:disable}
    max_open_conns: ${DB_MAX_OPEN_CONNS:25}
    max_idle_conns: ${DB_MAX_IDLE_CONNS:5}
    conn_max_lifetime: ${DB_CONN_MAX_LIFETIME:5m}
    conn_max_idle_time: ${DB_CONN_MAX_IDLE_TIME:5m}
    auto_migrate: ${DB_AUTO_MIGRATE:false}
    migration_path: ${DB_MIGRATION_PATH:./migrations}

cache:
  enabled: ${CACHE_ENABLED:true}
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    db: ${REDIS_DB:0}
    dial_timeout: ${REDIS_DIAL_TIMEOUT:5s}
    read_timeout: ${REDIS_READ_TIMEOUT:3s}
    write_timeout: ${REDIS_WRITE_TIMEOUT:3s}
    pool_size: ${REDIS_POOL_SIZE:10}
    min_idle_conns: ${REDIS_MIN_IDLE_CONNS:5}
    max_retries: ${REDIS_MAX_RETRIES:3}
    pool_timeout: ${REDIS_POOL_TIMEOUT:4s}
  
location_service:
  enabled: ${LOCATION_SERVICE_ENABLED:true}
  endpoint: ${LOCATION_SERVICE_ENDPOINT:http://localhost:8090/lookup}

auth:
  jwt:
    access_token_ttl: ${JWT_ACCESS_TOKEN_TTL:15m}
    refresh_token_ttl: ${JWT_REFRESH_TOKEN_TTL:168h}
    secret_key: ${JWT_SECRET_KEY}
    issuer: ${JWT_ISSUER:auth-service}
    audience: ${JWT_AUDIENCE:api}
    leeway: ${JWT_LEEWAY:1m}
  password:
    min_length: ${PASSWORD_MIN_LENGTH:8}
    require_uppercase: ${PASSWORD_REQUIRE_UPPERCASE:true}
    require_lowercase: ${PASSWORD_REQUIRE_LOWERCASE:true}
    require_number: ${PASSWORD_REQUIRE_NUMBER:true}
    require_special: ${PASSWORD_REQUIRE_SPECIAL:true}
    bcrypt_cost: ${PASSWORD_BCRYPT_COST:12}
  email_verification:
    enabled: ${EMAIL_VERIFICATION_ENABLED:true}
    token_ttl: ${EMAIL_VERIFICATION_TOKEN_TTL:24h}
    resend_cooldown: ${EMAIL_VERIFICATION_RESEND_COOLDOWN:1m}
  password_reset:
    enabled: ${PASSWORD_RESET_ENABLED:true}
    token_ttl: ${PASSWORD_RESET_TOKEN_TTL:1h}
  session:
    max_active_sessions: ${SESSION_MAX_ACTIVE:5}
    idle_timeout: ${SESSION_IDLE_TIMEOUT:30m}
    absolute_timeout: ${SESSION_ABSOLUTE_TIMEOUT:24h}
  encryption:
    algorithm: ${AUTH_ENCRYPTION_ALGORITHM:aes-256-gcm}
    key: ${AUTH_ENCRYPTION_KEY:}
    salt: ${AUTH_ENCRYPTION_SALT:}
    iterations: ${AUTH_ENCRYPTION_ITERATIONS:100000}
    key_derivation: ${AUTH_ENCRYPTION_KEY_DERIVATION:PBKDF2}
  hash:
    default: ${HASH_DEFAULT:argon2id}
    algorithm: ${HASH_ALGORITHM:argon2id}
    iterations: ${HASH_ITERATIONS:3}
    salt_length: ${HASH_SALT_LENGTH:16}
    key_length: ${HASH_KEY_LENGTH:32}
    cost: ${HASH_BCRYPT_COST:12}

security:
  allowed_origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:8080}
  allowed_methods: ${CORS_ALLOWED_METHODS:GET,POST,PUT,PATCH,DELETE,OPTIONS}
  allowed_headers: ${CORS_ALLOWED_HEADERS:Content-Type,Authorization,X-Request-ID,X-Correlation-ID}
  allow_credentials: ${CORS_ALLOW_CREDENTIALS:true}
  max_age: ${CORS_MAX_AGE:3600}
  security_headers:
    x_frame_options: ${SECURITY_X_FRAME_OPTIONS:DENY}
    x_content_type_options: ${SECURITY_X_CONTENT_TYPE_OPTIONS:nosniff}
    x_xss_protection: ${SECURITY_X_XSS_PROTECTION:1; mode=block}
    strict_transport_security: ${SECURITY_HSTS:max-age=31536000; includeSubDomains}
    content_security_policy: ${SECURITY_CSP:default-src 'self'}
  max_body_size: ${SECURITY_MAX_BODY_SIZE:1048576}
  rate_limit:
    enabled: ${RATE_LIMIT_ENABLED:true}
    window: ${RATE_LIMIT_WINDOW:1m}
    global:
      requests: ${RATE_LIMIT_GLOBAL_REQUESTS:100}
    endpoints:
      register:
        requests: ${RATE_LIMIT_REGISTER_REQUESTS:5}
        window: ${RATE_LIMIT_REGISTER_WINDOW:1h}
      login:
        requests: ${RATE_LIMIT_LOGIN_REQUESTS:10}
        window: ${RATE_LIMIT_LOGIN_WINDOW:15m}
      forgot_password:
        requests: ${RATE_LIMIT_FORGOT_PASSWORD_REQUESTS:3}
        window: ${RATE_LIMIT_FORGOT_PASSWORD_WINDOW:1h}

logging:
  level: ${LOG_LEVEL:info}
  format: ${LOG_FORMAT:json}
  output: ${LOG_OUTPUT:stdout}
  time_format: ${LOG_TIME_FORMAT:rfc3339}
  file:
    path: ${LOG_FILE_PATH:./logs/auth-service.log}
    max_size: ${LOG_FILE_MAX_SIZE:100}
    max_backups: ${LOG_FILE_MAX_BACKUPS:3}
    max_age: ${LOG_FILE_MAX_AGE:28}
    compress: ${LOG_FILE_COMPRESS:true}

email:
  enabled: ${EMAIL_ENABLED:false}
  provider: ${EMAIL_PROVIDER:smtp}
  smtp:
    host: ${SMTP_HOST:smtp.gmail.com}
    port: ${SMTP_PORT:587}
    username: ${SMTP_USERNAME}
    password: ${SMTP_PASSWORD}
    from_email: ${SMTP_FROM_EMAIL:noreply@example.com}
    from_name: ${SMTP_FROM_NAME:Auth Service}
    use_tls: ${SMTP_USE_TLS:true}
  templates:
    verification_subject: ${EMAIL_VERIFICATION_SUBJECT:Verify Your Email}
    password_reset_subject: ${EMAIL_PASSWORD_RESET_SUBJECT:Reset Your Password}

observability:
  metrics:
    enabled: ${METRICS_ENABLED:true}
    endpoint: ${METRICS_ENDPOINT:/metrics}
  tracing:
    enabled: ${TRACING_ENABLED:false}
    provider: ${TRACING_PROVIDER:jaeger}
    endpoint: ${TRACING_ENDPOINT:http://localhost:14268/api/traces}
    sample_rate: ${TRACING_SAMPLE_RATE:0.1}
  health:
    enabled: ${HEALTH_ENABLED:true}
    endpoint: ${HEALTH_ENDPOINT:/health}

shutdown:
  timeout: ${SHUTDOWN_TIMEOUT:30s}
  wait_for_connections: ${SHUTDOWN_WAIT_FOR_CONNECTIONS:true}
  drain_timeout: ${SHUTDOWN_DRAIN_TIMEOUT:5s}

features:
  oauth:
    enabled: ${FEATURE_OAUTH_ENABLED:false}
    providers:
      google:
        enabled: ${OAUTH_GOOGLE_ENABLED:false}
        client_id: ${OAUTH_GOOGLE_CLIENT_ID:}
        client_secret: ${OAUTH_GOOGLE_CLIENT_SECRET:}
      github:
        enabled: ${OAUTH_GITHUB_ENABLED:false}
        client_id: ${OAUTH_GITHUB_CLIENT_ID:}
        client_secret: ${OAUTH_GITHUB_CLIENT_SECRET:}
  two_factor:
    enabled: ${FEATURE_2FA_ENABLED:false}
    issuer: ${2FA_ISSUER:AuthService}
  magic_link:
    enabled: ${FEATURE_MAGIC_LINK_ENABLED:false}
    token_ttl: ${MAGIC_LINK_TOKEN_TTL:15m}