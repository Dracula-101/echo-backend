service:
  name: user-service
  version: 1.0.0
  environment: ${ENV:development}

server:
  port: ${SERVER_PORT:8084}
  host: ${SERVER_HOST:0.0.0.0}
  read_timeout: ${SERVER_READ_TIMEOUT:15s}
  write_timeout: ${SERVER_WRITE_TIMEOUT:15s}
  idle_timeout: ${SERVER_IDLE_TIMEOUT:60s}
  shutdown_timeout: ${SERVER_SHUTDOWN_TIMEOUT:30s}
  max_header_bytes: ${SERVER_MAX_HEADER_BYTES:1048576}
  enable_compression: ${SERVER_ENABLE_COMPRESSION:true}
  tls_enabled: ${TLS_ENABLED:false}
  tls_cert_file: ${TLS_CERT_FILE:}
  tls_key_file: ${TLS_KEY_FILE:}
  location_service_endpoint: ${LOCATION_SERVICE_ENDPOINT:http://localhost:8085}

database:
  postgres:
    host: ${DB_HOST:localhost}
    port: ${DB_PORT:5432}
    user: ${DB_USER:postgres}
    password: ${DB_PASSWORD}
    db_name: ${DB_NAME:echo_db}
    ssl_mode: ${DB_SSL_MODE:disable}
    max_open_conns: ${DB_MAX_OPEN_CONNS:25}
    max_idle_conns: ${DB_MAX_IDLE_CONNS:5}
    conn_max_lifetime: ${DB_CONN_MAX_LIFETIME:5m}
    conn_max_idle_time: ${DB_CONN_MAX_IDLE_TIME:5m}
    auto_migrate: ${DB_AUTO_MIGRATE:false}
    migration_path: ${DB_MIGRATION_PATH:./migrations}

cache:
  enabled: ${CACHE_ENABLED:true}
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    db: ${REDIS_DB:0}
    dial_timeout: ${REDIS_DIAL_TIMEOUT:5s}
    read_timeout: ${REDIS_READ_TIMEOUT:3s}
    write_timeout: ${REDIS_WRITE_TIMEOUT:3s}
    pool_size: ${REDIS_POOL_SIZE:10}
    min_idle_conns: ${REDIS_MIN_IDLE_CONNS:5}
    max_retries: ${REDIS_MAX_RETRIES:3}
    pool_timeout: ${REDIS_POOL_TIMEOUT:4s}

security:
  allowed_origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:8080}
  allowed_methods: ${CORS_ALLOWED_METHODS:GET,POST,PUT,PATCH,DELETE,OPTIONS}
  allowed_headers: ${CORS_ALLOWED_HEADERS:Content-Type,Authorization,X-Request-ID,X-Correlation-ID}
  allow_credentials: ${CORS_ALLOW_CREDENTIALS:true}
  max_age: ${CORS_MAX_AGE:3600}
  security_headers:
    x_frame_options: ${SECURITY_X_FRAME_OPTIONS:DENY}
    x_content_type_options: ${SECURITY_X_CONTENT_TYPE_OPTIONS:nosniff}
    x_xss_protection: ${SECURITY_X_XSS_PROTECTION:1; mode=block}
    strict_transport_security: ${SECURITY_HSTS:max-age=31536000; includeSubDomains}
    content_security_policy: ${SECURITY_CSP:default-src 'self'}
  max_body_size: ${SECURITY_MAX_BODY_SIZE:1048576}
  rate_limit:
    enabled: ${RATE_LIMIT_ENABLED:true}
    window: ${RATE_LIMIT_WINDOW:1m}
    global:
      requests: ${RATE_LIMIT_GLOBAL_REQUESTS:100}
    endpoints:
      get_profile:
        requests: ${RATE_LIMIT_GET_PROFILE_REQUESTS:60}
        window: ${RATE_LIMIT_GET_PROFILE_WINDOW:1m}
      update_profile:
        requests: ${RATE_LIMIT_UPDATE_PROFILE_REQUESTS:10}
        window: ${RATE_LIMIT_UPDATE_PROFILE_WINDOW:1m}
      search_users:
        requests: ${RATE_LIMIT_SEARCH_USERS_REQUESTS:30}
        window: ${RATE_LIMIT_SEARCH_USERS_WINDOW:1m}

logging:
  level: ${LOG_LEVEL:info}
  format: ${LOG_FORMAT:json}
  output: ${LOG_OUTPUT:stdout}
  time_format: ${LOG_TIME_FORMAT:rfc3339}
  file:
    path: ${LOG_FILE_PATH:./logs/user-service.log}
    max_size: ${LOG_FILE_MAX_SIZE:100}
    max_backups: ${LOG_FILE_MAX_BACKUPS:3}
    max_age: ${LOG_FILE_MAX_AGE:28}
    compress: ${LOG_FILE_COMPRESS:true}

observability:
  metrics:
    enabled: ${METRICS_ENABLED:true}
    endpoint: ${METRICS_ENDPOINT:/metrics}
  tracing:
    enabled: ${TRACING_ENABLED:false}
    provider: ${TRACING_PROVIDER:jaeger}
    endpoint: ${TRACING_ENDPOINT:http://localhost:14268/api/traces}
    sample_rate: ${TRACING_SAMPLE_RATE:0.1}
  health:
    enabled: ${HEALTH_ENABLED:true}
    endpoint: ${HEALTH_ENDPOINT:/health}

shutdown:
  timeout: ${SHUTDOWN_TIMEOUT:30s}
  wait_for_connections: ${SHUTDOWN_WAIT_FOR_CONNECTIONS:true}
  drain_timeout: ${SHUTDOWN_DRAIN_TIMEOUT:5s}

features:
  profile_picture:
    enabled: ${FEATURE_PROFILE_PICTURE_ENABLED:true}
    max_size_bytes: ${PROFILE_PICTURE_MAX_SIZE:5242880}
    allowed_formats: ${PROFILE_PICTURE_FORMATS:jpg,jpeg,png,webp}
  user_blocking:
    enabled: ${FEATURE_USER_BLOCKING_ENABLED:true}
  user_search:
    enabled: ${FEATURE_USER_SEARCH_ENABLED:true}
    max_results: ${USER_SEARCH_MAX_RESULTS:50}
    min_query_length: ${USER_SEARCH_MIN_QUERY_LENGTH:2}

jwt:
  secret_key: ${JWT_SECRET_KEY:your-secret-key}
  issuer: ${JWT_ISSUER:user-service}
  audience: ${JWT_AUDIENCE:user-service-clients}
  signing_method: ${JWT_SIGNING_METHOD:HS256}
  access_token_ttl: ${JWT_ACCESS_TOKEN_TTL:15m}
  refresh_token_ttl : ${JWT_REFRESH_TOKEN_TTL:7d}

